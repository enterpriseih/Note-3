## åç¨‹æ˜¯ä»€ä¹ˆ

åç¨‹å¹¶ä¸æ˜¯ Kotlin æå‡ºæ¥çš„æ–°æ¦‚å¿µï¼Œå…¶ä»–çš„ä¸€äº›ç¼–ç¨‹è¯­è¨€ï¼Œä¾‹å¦‚ï¼šGoã€Python ç­‰éƒ½å¯ä»¥åœ¨è¯­è¨€å±‚é¢ä¸Šå®ç°åç¨‹ï¼Œç”šè‡³æ˜¯ Javaï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨æ‰©å±•åº“æ¥é—´æ¥åœ°æ”¯æŒåç¨‹ã€‚

å½“åœ¨ç½‘ä¸Šæœç´¢åç¨‹æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ï¼š

- Kotlin å®˜æ–¹æ–‡æ¡£è¯´ã€Œæœ¬è´¨ä¸Šï¼Œåç¨‹æ˜¯è½»é‡çº§çš„çº¿ç¨‹ã€ã€‚
- å¾ˆå¤šåšå®¢æåˆ°ã€Œä¸éœ€è¦ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ã€ã€ã€Œæ˜¯åä½œå¼çš„ã€ç­‰ç­‰ã€‚

ä½œä¸º Kotlin åç¨‹çš„åˆå­¦è€…ï¼Œè¿™äº›æ¦‚å¿µå¹¶ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“è®©äººç†è§£ã€‚è¿™äº›å¾€å¾€æ˜¯ä½œè€…æ ¹æ®è‡ªå·±çš„ç»éªŒæ€»ç»“å‡ºæ¥çš„ï¼Œåªçœ‹ç»“æœï¼Œè€Œ**ä¸ç®¡è¿‡ç¨‹å°±ä¸å®¹æ˜“ç†è§£åç¨‹**ã€‚

ã€Œåç¨‹ Coroutinesã€æºè‡ª Simula å’Œ Modula-2 è¯­è¨€ï¼Œè¿™ä¸ªæœ¯è¯­æ—©åœ¨ 1958 å¹´å°±è¢« [Melvin Edward Conway](https://rengwuxian.com/kotlin-coroutines-1/[https://zh.wikipedia.org/wiki/é©¬å°”æ–‡Â·åº·å¨](https://zh.wikipedia.org/wiki/é©¬å°”æ–‡Â·åº·å¨)) å‘æ˜å¹¶ç”¨äºæ„å»ºæ±‡ç¼–ç¨‹åºï¼Œè¯´æ˜**åç¨‹æ˜¯ä¸€ç§ç¼–ç¨‹æ€æƒ³**ï¼Œå¹¶ä¸å±€é™äºç‰¹å®šçš„è¯­è¨€ã€‚

Go è¯­è¨€ä¹Ÿæœ‰åç¨‹ï¼Œå« Goroutinesï¼Œä»è‹±æ–‡æ‹¼å†™å°±çŸ¥é“å®ƒå’Œ Coroutines è¿˜æ˜¯æœ‰äº›å·®åˆ«çš„ï¼ˆè®¾è®¡æ€æƒ³ä¸Šæ˜¯æœ‰å…³ç³»çš„ï¼‰ï¼Œå¦åˆ™ Kotlin çš„åç¨‹å®Œå…¨å¯ä»¥å« Koroutines äº†ã€‚

å› æ­¤ï¼Œå¯¹ä¸€ä¸ªæ–°æœ¯è¯­ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ä»€ä¹ˆæ˜¯ã€Œæ ‡å‡†ã€æœ¯è¯­ï¼Œä»€ä¹ˆæ˜¯å˜ç§ã€‚

å½“æˆ‘ä»¬è®¨è®ºåç¨‹å’Œçº¿ç¨‹çš„å…³ç³»æ—¶ï¼Œå¾ˆå®¹æ˜“**é™·å…¥ä¸­æ–‡çš„è¯¯åŒº**ï¼Œä¸¤è€…éƒ½æœ‰ä¸€ä¸ªã€Œç¨‹ã€å­—ï¼Œå°±è§‰å¾—æœ‰å…³ç³»ï¼Œå…¶å®å°±è‹±æ–‡è€Œè¨€ï¼ŒCoroutines å’Œ Threads å°±æ˜¯ä¸¤ä¸ªæ¦‚å¿µã€‚

ä» Android å¼€å‘è€…çš„è§’åº¦å»ç†è§£å®ƒä»¬çš„å…³ç³»ï¼š

- æˆ‘ä»¬æ‰€æœ‰çš„ä»£ç éƒ½æ˜¯è·‘åœ¨çº¿ç¨‹ä¸­çš„ï¼Œè€Œçº¿ç¨‹æ˜¯è·‘åœ¨è¿›ç¨‹ä¸­çš„ã€‚
- åç¨‹æ²¡æœ‰ç›´æ¥å’Œæ“ä½œç³»ç»Ÿå…³è”ï¼Œä½†å®ƒä¸æ˜¯ç©ºä¸­æ¥¼é˜ï¼Œå®ƒä¹Ÿæ˜¯è·‘åœ¨çº¿ç¨‹ä¸­çš„ï¼Œå¯ä»¥æ˜¯å•çº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šçº¿ç¨‹ã€‚
- å•çº¿ç¨‹ä¸­çš„åç¨‹æ€»çš„æ‰§è¡Œæ—¶é—´å¹¶ä¸ä¼šæ¯”ä¸ç”¨åç¨‹å°‘ã€‚
- Android ç³»ç»Ÿä¸Šï¼Œå¦‚æœåœ¨ä¸»çº¿ç¨‹è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼Œä¼šæŠ›å‡º `NetworkOnMainThreadException`ï¼Œå¯¹äºåœ¨ä¸»çº¿ç¨‹ä¸Šçš„åç¨‹ä¹Ÿä¸ä¾‹å¤–ï¼Œè¿™ç§åœºæ™¯ä½¿ç”¨åç¨‹è¿˜æ˜¯è¦åˆ‡çº¿ç¨‹çš„ã€‚

åç¨‹è®¾è®¡çš„åˆè¡·æ˜¯ä¸ºäº†è§£å†³å¹¶å‘é—®é¢˜ï¼Œè®© ã€Œåä½œå¼å¤šä»»åŠ¡ã€ å®ç°èµ·æ¥æ›´åŠ æ–¹ä¾¿ã€‚è¿™é‡Œå°±å…ˆä¸å±•å¼€ã€Œåä½œå¼å¤šä»»åŠ¡ã€çš„æ¦‚å¿µï¼Œç­‰æˆ‘ä»¬å­¦ä¼šäº†æ€ä¹ˆç”¨å†è®²ã€‚

è§†é¢‘é‡Œè®²åˆ°ï¼Œåç¨‹å°±æ˜¯ Kotlin æä¾›çš„ä¸€å¥—çº¿ç¨‹å°è£…çš„ APIï¼Œä½†å¹¶ä¸æ˜¯è¯´åç¨‹å°±æ˜¯ä¸ºçº¿ç¨‹è€Œç”Ÿçš„ã€‚

ä¸è¿‡ï¼Œæˆ‘ä»¬å­¦ä¹  Kotlin ä¸­çš„åç¨‹ï¼Œä¸€å¼€å§‹ç¡®å®å¯ä»¥ä»çº¿ç¨‹æ§åˆ¶çš„è§’åº¦æ¥åˆ‡å…¥ã€‚å› ä¸ºåœ¨ Kotlin ä¸­ï¼Œåç¨‹çš„ä¸€ä¸ªå…¸å‹çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯çº¿ç¨‹æ§åˆ¶ã€‚å°±åƒ Java ä¸­çš„ `Executor` å’Œ Android ä¸­çš„ `AsyncTask`ï¼ŒKotlin ä¸­çš„åç¨‹ä¹Ÿæœ‰å¯¹ Thread API çš„å°è£…ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨å†™ä»£ç æ—¶ï¼Œä¸ç”¨å…³æ³¨å¤šçº¿ç¨‹å°±èƒ½å¤Ÿå¾ˆæ–¹ä¾¿åœ°å†™å‡ºå¹¶å‘æ“ä½œã€‚

åœ¨ Java ä¸­è¦å®ç°å¹¶å‘æ“ä½œé€šå¸¸éœ€è¦å¼€å¯ä¸€ä¸ª `Thread` ï¼š

```java
â˜•ï¸
new Thread(new Runnable() {
    @Override
    public void run() {
        ...
    }
}).start();
```

è¿™é‡Œä»…ä»…åªæ˜¯å¼€å¯äº†ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œè‡³äºå®ƒä½•æ—¶ç»“æŸã€æ‰§è¡Œç»“æœæ€ä¹ˆæ ·ï¼Œæˆ‘ä»¬åœ¨ä¸»çº¿ç¨‹ä¸­æ˜¯æ— æ³•ç›´æ¥çŸ¥é“çš„ã€‚

Kotlin ä¸­åŒæ ·å¯ä»¥é€šè¿‡çº¿ç¨‹çš„æ–¹å¼å»å†™ï¼š

```kotlin
ğŸï¸
Thread({
    ...
}).start()
```

å¯ä»¥çœ‹åˆ°ï¼Œå’Œ Java ä¸€æ ·ä¹Ÿæ‘†è„±ä¸äº†ç›´æ¥ä½¿ç”¨ `Thread` çš„é‚£äº›å›°éš¾å’Œä¸æ–¹ä¾¿ï¼š

- çº¿ç¨‹ä»€ä¹ˆæ—¶å€™æ‰§è¡Œç»“æŸ
- çº¿ç¨‹é—´çš„ç›¸äº’é€šä¿¡
- å¤šä¸ªçº¿ç¨‹çš„ç®¡ç†

æˆ‘ä»¬å¯ä»¥ç”¨ Java çš„ `Executor` çº¿ç¨‹æ± æ¥è¿›è¡Œçº¿ç¨‹ç®¡ç†ï¼š

```kotlin
ğŸï¸
val executor = Executors.newCachedThreadPool()
executor.execute({
    ...
})
```

ç”¨ Android çš„ `AsyncTask` æ¥è§£å†³çº¿ç¨‹é—´é€šä¿¡ï¼š

```kotlin
ğŸï¸
object : AsyncTask&lt;T0, T1, T2&gt; { 
    override fun doInBackground(vararg args: T0): String { ... }
    override fun onProgressUpdate(vararg args: T1) { ... }
    override fun onPostExecute(t3: T3) { ... }
}
```

`AsyncTask` æ˜¯ Android å¯¹çº¿ç¨‹æ±  `Executor` çš„å°è£…ï¼Œä½†å®ƒçš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼š

- éœ€è¦å¤„ç†å¾ˆå¤šå›è°ƒï¼Œå¦‚æœä¸šåŠ¡å¤šåˆ™å®¹æ˜“é™·å…¥ã€Œå›è°ƒåœ°ç‹±ã€ã€‚
- ç¡¬æ˜¯æŠŠä¸šåŠ¡æ‹†åˆ†æˆäº†å‰å°ã€ä¸­é—´æ›´æ–°ã€åå°ä¸‰ä¸ªå‡½æ•°ã€‚

çœ‹åˆ°è¿™é‡Œä½ å¾ˆè‡ªç„¶æƒ³åˆ°ä½¿ç”¨ RxJava è§£å†³å›è°ƒåœ°ç‹±ï¼Œå®ƒç¡®å®å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³ä¸Šé¢çš„é—®é¢˜ã€‚

RxJavaï¼Œå‡†ç¡®æ¥è®²æ˜¯ ReactiveX åœ¨ Java ä¸Šçš„å®ç°ï¼Œæ˜¯ä¸€ç§å“åº”å¼ç¨‹åºæ¡†æ¶ï¼Œæˆ‘ä»¬é€šè¿‡å®ƒæä¾›çš„ã€ŒObservableã€çš„ç¼–ç¨‹èŒƒå¼è¿›è¡Œé“¾å¼è°ƒç”¨ï¼Œå¯ä»¥å¾ˆå¥½åœ°æ¶ˆé™¤å›è°ƒã€‚

ä½¿ç”¨åç¨‹ï¼ŒåŒæ ·å¯ä»¥åƒ Rx é‚£æ ·æœ‰æ•ˆåœ°æ¶ˆé™¤å›è°ƒåœ°ç‹±ï¼Œä¸è¿‡æ— è®ºæ˜¯è®¾è®¡ç†å¿µï¼Œè¿˜æ˜¯ä»£ç é£æ ¼ï¼Œä¸¤è€…æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«çš„ï¼Œåç¨‹åœ¨å†™æ³•ä¸Šå’Œæ™®é€šçš„é¡ºåºä»£ç ç±»ä¼¼ã€‚

> è¿™é‡Œå¹¶ä¸ä¼šæ¯”è¾ƒ RxJava å’Œåç¨‹å“ªä¸ªå¥½ï¼Œæˆ–è€…è®¨è®ºè°å–ä»£è°çš„é—®é¢˜ï¼Œæˆ‘è¿™é‡Œåªç»™å‡ºä¸€ä¸ªå»ºè®®ï¼Œä½ æœ€å¥½éƒ½å»äº†è§£ä¸‹ï¼Œå› ä¸ºåç¨‹å’Œ Rx çš„è®¾è®¡æ€æƒ³æœ¬æ¥å°±ä¸åŒã€‚

ä¸‹é¢çš„ä¾‹å­æ˜¯ä½¿ç”¨åç¨‹è¿›è¡Œç½‘ç»œè¯·æ±‚è·å–ç”¨æˆ·ä¿¡æ¯å¹¶æ˜¾ç¤ºåˆ° UI æ§ä»¶ä¸Šï¼š

```kotlin
ğŸï¸
launch({
    val user = api.getUser() // ğŸ‘ˆ ç½‘ç»œè¯·æ±‚ï¼ˆIO çº¿ç¨‹ï¼‰
    nameTv.text = user.name  // ğŸ‘ˆ æ›´æ–° UIï¼ˆä¸»çº¿ç¨‹ï¼‰
})
```

è¿™é‡Œåªæ˜¯å±•ç¤ºäº†ä¸€ä¸ªä»£ç ç‰‡æ®µï¼Œ`launch` å¹¶ä¸æ˜¯ä¸€ä¸ªé¡¶å±‚å‡½æ•°ï¼Œå®ƒå¿…é¡»åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¹‹åå†è®²ï¼Œè¿™é‡Œåªå…³å¿ƒå®ƒå†…éƒ¨ä¸šåŠ¡é€»è¾‘çš„å†™æ³•ã€‚

`launch` å‡½æ•°åŠ ä¸Šå®ç°åœ¨ `{}` ä¸­å…·ä½“çš„é€»è¾‘ï¼Œå°±æ„æˆäº†ä¸€ä¸ªåç¨‹ã€‚

é€šå¸¸æˆ‘ä»¬åšç½‘ç»œè¯·æ±‚ï¼Œè¦ä¸å°±ä¼ ä¸€ä¸ª callbackï¼Œè¦ä¸å°±æ˜¯åœ¨ IO çº¿ç¨‹é‡Œè¿›è¡Œé˜»å¡å¼çš„åŒæ­¥è°ƒç”¨ï¼Œè€Œåœ¨è¿™æ®µä»£ç ä¸­ï¼Œä¸Šä¸‹ä¸¤ä¸ªè¯­å¥åˆ†åˆ«å·¥ä½œåœ¨ä¸¤ä¸ªçº¿ç¨‹é‡Œï¼Œä½†å†™æ³•ä¸Šçœ‹èµ·æ¥å’Œæ™®é€šçš„å•çº¿ç¨‹ä»£ç ä¸€æ ·ã€‚

è¿™é‡Œçš„ `api.getUser` æ˜¯ä¸€ä¸ª**æŒ‚èµ·å‡½æ•°**ï¼Œæ‰€ä»¥èƒ½å¤Ÿä¿è¯ `nameTv.text` çš„æ­£ç¡®èµ‹å€¼ï¼Œè¿™å°±æ¶‰åŠåˆ°äº†åç¨‹ä¸­æœ€è‘—åçš„ã€Œéé˜»å¡å¼æŒ‚èµ·ã€ã€‚è¿™ä¸ªåè¯çœ‹èµ·æ¥ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ç†è§£ï¼Œæˆ‘ä»¬åç»­çš„æ–‡ç« ä¼šä¸“é—¨å¯¹è¿™ä¸ªæ¦‚å¿µè¿›è¡Œè®²è§£ã€‚ç°åœ¨å…ˆæŠŠè¿™ä¸ªæ¦‚å¿µæ”¾ä¸‹ï¼Œåªéœ€è¦è®°ä½åç¨‹å°±æ˜¯è¿™æ ·å†™çš„å°±è¡Œäº†ã€‚

è¿™ç§ã€Œç”¨åŒæ­¥çš„æ–¹å¼å†™å¼‚æ­¥çš„ä»£ç ã€çœ‹èµ·æ¥å¾ˆæ–¹ä¾¿å§ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹çœ‹åç¨‹å…·ä½“å¥½åœ¨å“ªã€‚

## åç¨‹å¥½åœ¨å“ª

### å¼€å§‹ä¹‹å‰

åœ¨è®²ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹ã€Œé—­åŒ…ã€è¿™ä¸ªæ¦‚å¿µï¼Œè°ƒç”¨ Kotlin åç¨‹ä¸­çš„ APIï¼Œç»å¸¸ä¼šç”¨åˆ°é—­åŒ…å†™æ³•ã€‚

å…¶å®é—­åŒ…å¹¶ä¸æ˜¯ Kotlin ä¸­çš„æ–°æ¦‚å¿µï¼Œåœ¨ Java 8 ä¸­å°±å·²ç»æ”¯æŒã€‚

æˆ‘ä»¬å…ˆä»¥ `Thread` ä¸ºä¾‹ï¼Œæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯é—­åŒ…ï¼š

```kotlin
ğŸï¸
// åˆ›å»ºä¸€ä¸ª Thread çš„å®Œæ•´å†™æ³•
Thread(object : Runnable {
    override fun run() {
        ...
    }
})

// æ»¡è¶³ SAMï¼Œå…ˆç®€åŒ–ä¸º
Thread({
    ...
})

// ä½¿ç”¨é—­åŒ…ï¼Œå†ç®€åŒ–ä¸º
Thread {
    ...
}
```

å½¢å¦‚ `Thread {...}` è¿™æ ·çš„ç»“æ„ä¸­ `{}` å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚

åœ¨ Kotlin ä¸­æœ‰è¿™æ ·ä¸€ä¸ªè¯­æ³•ç³–ï¼šå½“å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ lambda è¡¨è¾¾å¼æ—¶ï¼Œå¯ä»¥å°† lambda å†™åœ¨æ‹¬å·å¤–ã€‚è¿™å°±æ˜¯å®ƒçš„é—­åŒ…åŸåˆ™ã€‚

åœ¨è¿™é‡Œéœ€è¦ä¸€ä¸ªç±»å‹ä¸º `Runnable` çš„å‚æ•°ï¼Œè€Œ `Runnable` æ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸”åªå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° `run`ï¼Œè¿™ç§æƒ…å†µæ»¡è¶³äº† Kotlin çš„ [SAM](https://medium.com/tompee/idiomatic-kotlin-lambdas-and-sam-constructors-fe2075965bfb)ï¼Œå¯ä»¥è½¬æ¢æˆä¼ é€’ä¸€ä¸ª lambda è¡¨è¾¾å¼ï¼ˆç¬¬äºŒæ®µï¼‰ï¼Œå› ä¸ºæ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œæ ¹æ®é—­åŒ…åŸåˆ™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å†™æˆ `Thread {...}`ï¼ˆç¬¬ä¸‰æ®µï¼‰ çš„å½¢å¼ã€‚

å¯¹äºä¸Šæ–‡æ‰€ä½¿ç”¨çš„ `launch` å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡é—­åŒ…æ¥è¿›è¡Œç®€åŒ– ï¼š

```kotlin
ğŸï¸
launch {
    ...
}
```

### åŸºæœ¬ä½¿ç”¨

å‰é¢æåˆ°ï¼Œ`launch` å‡½æ•°ä¸æ˜¯é¡¶å±‚å‡½æ•°ï¼Œæ˜¯ä¸èƒ½ç›´æ¥ç”¨çš„ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸‰ç§æ–¹æ³•æ¥åˆ›å»ºåç¨‹ï¼š

```kotlin
ğŸï¸
// æ–¹æ³•ä¸€ï¼Œä½¿ç”¨ runBlocking é¡¶å±‚å‡½æ•°
runBlocking {
    getImage(imageId)
}

// æ–¹æ³•äºŒï¼Œä½¿ç”¨ GlobalScope å•ä¾‹å¯¹è±¡
//            ğŸ‘‡ å¯ä»¥ç›´æ¥è°ƒç”¨ launch å¼€å¯åç¨‹
GlobalScope.launch {
    getImage(imageId)
}

// æ–¹æ³•ä¸‰ï¼Œè‡ªè¡Œé€šè¿‡ CoroutineContext åˆ›å»ºä¸€ä¸ª CoroutineScope å¯¹è±¡
//                                    ğŸ‘‡ éœ€è¦ä¸€ä¸ªç±»å‹ä¸º CoroutineContext çš„å‚æ•°
val coroutineScope = CoroutineScope(context)
coroutineScope.launch {
    getImage(imageId)
}
```

- æ–¹æ³•ä¸€é€šå¸¸é€‚ç”¨äºå•å…ƒæµ‹è¯•çš„åœºæ™¯ï¼Œè€Œä¸šåŠ¡å¼€å‘ä¸­ä¸ä¼šç”¨åˆ°è¿™ç§æ–¹æ³•ï¼Œå› ä¸ºå®ƒæ˜¯çº¿ç¨‹é˜»å¡çš„ã€‚
- æ–¹æ³•äºŒå’Œä½¿ç”¨ `runBlocking` çš„åŒºåˆ«åœ¨äºä¸ä¼šé˜»å¡çº¿ç¨‹ã€‚ä½†åœ¨ Android å¼€å‘ä¸­åŒæ ·ä¸æ¨èè¿™ç§ç”¨æ³•ï¼Œå› ä¸ºå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¼šå’Œ app ä¸€è‡´ï¼Œä¸”ä¸èƒ½å–æ¶ˆï¼ˆä»€ä¹ˆæ˜¯åç¨‹çš„å–æ¶ˆåé¢çš„æ–‡ç« ä¼šè®²ï¼‰ã€‚
- æ–¹æ³•ä¸‰æ˜¯æ¯”è¾ƒæ¨èçš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `context` å‚æ•°å»ç®¡ç†å’Œæ§åˆ¶åç¨‹çš„ç”Ÿå‘½å‘¨æœŸï¼ˆè¿™é‡Œçš„ `context` å’Œ Android é‡Œçš„ä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Œæ˜¯ä¸€ä¸ªæ›´é€šç”¨çš„æ¦‚å¿µï¼Œä¼šæœ‰ä¸€ä¸ª Android å¹³å°çš„å°è£…æ¥é…åˆä½¿ç”¨ï¼‰ã€‚

å…³äº `CoroutineScope` å’Œ `CoroutineContext` çš„æ›´å¤šå†…å®¹åé¢çš„æ–‡ç« å†è®²ã€‚

åç¨‹æœ€å¸¸ç”¨çš„åŠŸèƒ½æ˜¯å¹¶å‘ï¼Œè€Œå¹¶å‘çš„å…¸å‹åœºæ™¯å°±æ˜¯å¤šçº¿ç¨‹ã€‚å¯ä»¥ä½¿ç”¨ `Dispatchers.IO` å‚æ•°æŠŠä»»åŠ¡åˆ‡åˆ° IO çº¿ç¨‹æ‰§è¡Œï¼š

```kotlin
ğŸï¸
coroutineScope.launch(Dispatchers.IO) {
    ...
}
```

ä¹Ÿå¯ä»¥ä½¿ç”¨ `Dispatchers.Main` å‚æ•°åˆ‡æ¢åˆ°ä¸»çº¿ç¨‹ï¼š

```kotlin
ğŸï¸
coroutineScope.launch(Dispatchers.Main) {
    ...
}
```

æ‰€ä»¥åœ¨ã€Œåç¨‹æ˜¯ä»€ä¹ˆã€ä¸€èŠ‚ä¸­è®²åˆ°çš„å¼‚æ­¥è¯·æ±‚çš„ä¾‹å­å®Œæ•´å†™å‡ºæ¥æ˜¯è¿™æ ·çš„ï¼š

```kotlin
ğŸï¸
coroutineScope.launch(Dispatchers.Main) {   // åœ¨ä¸»çº¿ç¨‹å¼€å¯åç¨‹
    val user = api.getUser() // IO çº¿ç¨‹æ‰§è¡Œç½‘ç»œè¯·æ±‚
    nameTv.text = user.name  // ä¸»çº¿ç¨‹æ›´æ–° UI
}
```

è€Œé€šè¿‡ Java å®ç°ä»¥ä¸Šé€»è¾‘ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦è¿™æ ·å†™ï¼š

```java
â˜•ï¸
api.getUser(new Callback&lt;User&gt;() {
    @Override
    public void success(User user) {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                nameTv.setText(user.name);
            }
        })
    }
    
    @Override
    public void failure(Exception e) {
        ...
    }
});
```

è¿™ç§å›è°ƒå¼çš„å†™æ³•ï¼Œæ‰“ç ´äº†ä»£ç çš„é¡ºåºç»“æ„å’Œå®Œæ•´æ€§ï¼Œè¯»èµ·æ¥ç›¸å½“éš¾å—ã€‚

### åç¨‹çš„ã€Œ1 åˆ° 0ã€

å¯¹äºå›è°ƒå¼çš„å†™æ³•ï¼Œå¦‚æœå¹¶å‘åœºæ™¯å†å¤æ‚ä¸€äº›ï¼Œä»£ç çš„åµŒå¥—å¯èƒ½ä¼šæ›´å¤šï¼Œè¿™æ ·çš„è¯ç»´æŠ¤èµ·æ¥å°±éå¸¸éº»çƒ¦ã€‚ä½†å¦‚æœä½ ä½¿ç”¨äº† Kotlin åç¨‹ï¼Œå¤šå±‚ç½‘ç»œè¯·æ±‚åªéœ€è¦è¿™ä¹ˆå†™ï¼š

```kotlin
ğŸï¸
coroutineScope.launch(Dispatchers.Main) {       // å¼€å§‹åç¨‹ï¼šä¸»çº¿ç¨‹
    val token = api.getToken()                  // ç½‘ç»œè¯·æ±‚ï¼šIO çº¿ç¨‹
    val user = api.getUser(token)               // ç½‘ç»œè¯·æ±‚ï¼šIO çº¿ç¨‹
    nameTv.text = user.name                     // æ›´æ–° UIï¼šä¸»çº¿ç¨‹
}
```

å¦‚æœé‡åˆ°çš„åœºæ™¯æ˜¯å¤šä¸ªç½‘ç»œè¯·æ±‚éœ€è¦ç­‰å¾…æ‰€æœ‰è¯·æ±‚ç»“æŸä¹‹åå†å¯¹ UI è¿›è¡Œæ›´æ–°ã€‚æ¯”å¦‚ä»¥ä¸‹ä¸¤ä¸ªè¯·æ±‚ï¼š

```kotlin
ğŸï¸
api.getAvatar(user, callback)
api.getCompanyLogo(user, callback)
```

å¦‚æœä½¿ç”¨å›è°ƒå¼çš„å†™æ³•ï¼Œé‚£ä¹ˆä»£ç å¯èƒ½å†™èµ·æ¥æ—¢å›°éš¾åˆåˆ«æ‰­ã€‚äºæ˜¯æˆ‘ä»¬å¯èƒ½ä¼šé€‰æ‹©å¦¥åï¼Œé€šè¿‡å…ˆåè¯·æ±‚ä»£æ›¿åŒæ—¶è¯·æ±‚ï¼š

```kotlin
ğŸï¸
api.getAvatar(user) { avatar ->
    api.getCompanyLogo(user) { logo ->
        show(merge(avatar, logo))
    }
}
```

åœ¨å®é™…å¼€å‘ä¸­å¦‚æœè¿™æ ·å†™ï¼Œæœ¬æ¥èƒ½å¤Ÿå¹¶è¡Œå¤„ç†çš„è¯·æ±‚è¢«å¼ºåˆ¶é€šè¿‡ä¸²è¡Œçš„æ–¹å¼å»å®ç°ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç­‰å¾…æ—¶é—´é•¿äº†ä¸€å€ï¼Œä¹Ÿå°±æ˜¯æ€§èƒ½å·®äº†ä¸€å€ã€‚

è€Œå¦‚æœä½¿ç”¨åç¨‹ï¼Œå¯ä»¥ç›´æ¥æŠŠä¸¤ä¸ªå¹¶è¡Œè¯·æ±‚å†™æˆä¸Šä¸‹ä¸¤è¡Œï¼Œæœ€åå†æŠŠç»“æœè¿›è¡Œåˆå¹¶å³å¯ï¼š

```kotlin
ğŸï¸
coroutineScope.launch(Dispatchers.Main) {
    //            ğŸ‘‡  async å‡½æ•°ä¹‹åå†è®²
    val avatar = async { api.getAvatar(user) }    // è·å–ç”¨æˆ·å¤´åƒ
    val logo = async { api.getCompanyLogo(user) } // è·å–ç”¨æˆ·æ‰€åœ¨å…¬å¸çš„ logo
    val merged = suspendingMerge(avatar, logo)    // åˆå¹¶ç»“æœ
    //                  ğŸ‘†
    show(merged) // æ›´æ–° UI
}
```

å¯ä»¥çœ‹åˆ°ï¼Œå³ä¾¿æ˜¯æ¯”è¾ƒå¤æ‚çš„å¹¶è¡Œç½‘ç»œè¯·æ±‚ï¼Œä¹Ÿèƒ½å¤Ÿé€šè¿‡åç¨‹å†™å‡ºç»“æ„æ¸…æ™°çš„ä»£ç ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ `suspendingMerge` å¹¶ä¸æ˜¯åç¨‹ API ä¸­æä¾›çš„æ–¹æ³•ï¼Œè€Œæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¸€ä¸ªå¯ã€ŒæŒ‚èµ·ã€çš„ç»“æœåˆå¹¶æ–¹æ³•ã€‚è‡³äºæŒ‚èµ·å…·ä½“æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥çœ‹ä¸‹ä¸€ç¯‡æ–‡ç« ã€‚

è®©å¤æ‚çš„å¹¶å‘ä»£ç ï¼Œå†™èµ·æ¥å˜å¾—ç®€å•ä¸”æ¸…æ™°ï¼Œæ˜¯åç¨‹çš„ä¼˜åŠ¿ã€‚

è¿™é‡Œï¼Œä¸¤ä¸ªæ²¡æœ‰ç›¸å…³æ€§çš„åå°ä»»åŠ¡ï¼Œå› ä¸ºç”¨äº†åç¨‹ï¼Œè¢«å®‰æ’å¾—æ˜æ˜ç™½ç™½ï¼Œäº’ç›¸ä¹‹é—´é…åˆå¾—å¾ˆå¥½ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¹‹å‰è¯´çš„ã€Œåä½œå¼ä»»åŠ¡ã€ã€‚

æœ¬æ¥éœ€è¦å›è°ƒï¼Œç°åœ¨ç›´æ¥æ²¡æœ‰å›è°ƒäº†ï¼Œè¿™ç§ä» 1 åˆ° 0 çš„è®¾è®¡æ€æƒ³çœŸçš„å¦™å“‰ã€‚

åœ¨äº†è§£äº†åç¨‹çš„ä½œç”¨å’Œä¼˜åŠ¿ä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹åç¨‹æ˜¯æ€ä¹ˆä½¿ç”¨çš„ã€‚

## åç¨‹æ€ä¹ˆç”¨

### åœ¨é¡¹ç›®ä¸­é…ç½®å¯¹ Kotlin åç¨‹çš„æ”¯æŒ

åœ¨ä½¿ç”¨åç¨‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ `build.gradle` æ–‡ä»¶ä¸­å¢åŠ å¯¹ Kotlin åç¨‹çš„ä¾èµ–ï¼š

- é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `build.gradle` :

```groovy
buildscript {
    ...
    // ğŸ‘‡
    ext.kotlin_coroutines = '1.3.1'
    ...
}
```

- Module ä¸‹çš„ `build.gradle` :

```groovy
dependencies {
    ...
    //                                       ğŸ‘‡ ä¾èµ–åç¨‹æ ¸å¿ƒåº“
    implementation "org.jetbrains.kotlinx:kotlinx-coroutines-core:$kotlin_coroutines"
    //                                       ğŸ‘‡ ä¾èµ–å½“å‰å¹³å°æ‰€å¯¹åº”çš„å¹³å°åº“
    implementation "org.jetbrains.kotlinx:kotlinx-coroutines-android:$kotlin_coroutines"
    ...
}
```

Kotlin åç¨‹æ˜¯ä»¥å®˜æ–¹æ‰©å±•åº“çš„å½¢å¼è¿›è¡Œæ”¯æŒçš„ã€‚è€Œä¸”ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„ã€Œæ ¸å¿ƒåº“ã€å’Œ ã€Œå¹³å°åº“ã€çš„ç‰ˆæœ¬åº”è¯¥ä¿æŒä¸€è‡´ã€‚

- æ ¸å¿ƒåº“ä¸­åŒ…å«çš„ä»£ç ä¸»è¦æ˜¯åç¨‹çš„å…¬å…± API éƒ¨åˆ†ã€‚æœ‰äº†è¿™ä¸€å±‚å…¬å…±ä»£ç ï¼Œæ‰ä½¿å¾—åç¨‹åœ¨å„ä¸ªå¹³å°ä¸Šçš„æ¥å£å¾—åˆ°ç»Ÿä¸€ã€‚
- å¹³å°åº“ä¸­åŒ…å«çš„ä»£ç ä¸»è¦æ˜¯åç¨‹æ¡†æ¶åœ¨å…·ä½“å¹³å°çš„å…·ä½“å®ç°æ–¹å¼ã€‚å› ä¸ºå¤šçº¿ç¨‹åœ¨å„ä¸ªå¹³å°çš„å®ç°æ–¹å¼æ˜¯æœ‰æ‰€å·®å¼‚çš„ã€‚

å®Œæˆäº†ä»¥ä¸Šçš„å‡†å¤‡å·¥ä½œå°±å¯ä»¥å¼€å§‹ä½¿ç”¨åç¨‹äº†ã€‚

### å¼€å§‹ä½¿ç”¨åç¨‹

åç¨‹æœ€ç®€å•çš„ä½¿ç”¨æ–¹æ³•ï¼Œå…¶å®åœ¨å‰é¢ç« èŠ‚å°±å·²ç»çœ‹åˆ°äº†ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ª `launch` å‡½æ•°å®ç°çº¿ç¨‹åˆ‡æ¢çš„åŠŸèƒ½ï¼š

```kotlin
ğŸï¸
//               ğŸ‘‡
coroutineScope.launch(Dispatchers.IO) {
    ...
}
```

è¿™ä¸ª `launch` å‡½æ•°ï¼Œå®ƒå…·ä½“çš„å«ä¹‰æ˜¯ï¼šæˆ‘è¦åˆ›å»ºä¸€ä¸ªæ–°çš„åç¨‹ï¼Œå¹¶åœ¨æŒ‡å®šçš„çº¿ç¨‹ä¸Šè¿è¡Œå®ƒã€‚è¿™ä¸ªè¢«åˆ›å»ºã€è¢«è¿è¡Œçš„æ‰€è°“ã€Œåç¨‹ã€æ˜¯è°ï¼Ÿå°±æ˜¯ä½ ä¼ ç»™ `launch` çš„é‚£äº›ä»£ç ï¼Œè¿™ä¸€æ®µè¿ç»­ä»£ç å«åšä¸€ä¸ªã€Œåç¨‹ã€ã€‚

æ‰€ä»¥ï¼Œä»€ä¹ˆæ—¶å€™ç”¨åç¨‹ï¼Ÿå½“ä½ éœ€è¦åˆ‡çº¿ç¨‹æˆ–è€…æŒ‡å®šçº¿ç¨‹çš„æ—¶å€™ã€‚ä½ è¦åœ¨åå°æ‰§è¡Œä»»åŠ¡ï¼Ÿåˆ‡ï¼

```kotlin
ğŸï¸
launch(Dispatchers.IO) {
    val image = getImage(imageId)
}
```

ç„¶åéœ€è¦åœ¨å‰å°æ›´æ–°ç•Œé¢ï¼Ÿå†åˆ‡ï¼

```kotlin
ğŸï¸
coroutineScope.launch(Dispatchers.IO) {
    val image = getImage(imageId)
    launch(Dispatchers.Main) {
        avatarIv.setImageBitmap(image)
    }
}
```

å¥½åƒæœ‰ç‚¹ä¸å¯¹åŠ²ï¼Ÿè¿™ä¸è¿˜æ˜¯æœ‰åµŒå¥—å˜›ã€‚

å¦‚æœåªæ˜¯ä½¿ç”¨ `launch` å‡½æ•°ï¼Œåç¨‹å¹¶ä¸èƒ½æ¯”çº¿ç¨‹åšæ›´å¤šçš„äº‹ã€‚ä¸è¿‡åç¨‹ä¸­å´æœ‰ä¸€ä¸ªå¾ˆå®ç”¨çš„å‡½æ•°ï¼š`withContext` ã€‚è¿™ä¸ªå‡½æ•°å¯ä»¥åˆ‡æ¢åˆ°æŒ‡å®šçš„çº¿ç¨‹ï¼Œå¹¶åœ¨é—­åŒ…å†…çš„é€»è¾‘æ‰§è¡Œç»“æŸä¹‹åï¼Œè‡ªåŠ¨æŠŠçº¿ç¨‹åˆ‡å›å»ç»§ç»­æ‰§è¡Œã€‚é‚£ä¹ˆå¯ä»¥å°†ä¸Šé¢çš„ä»£ç å†™æˆè¿™æ ·ï¼š

```kotlin
ğŸï¸
coroutineScope.launch(Dispatchers.Main) {      // ğŸ‘ˆ åœ¨ UI çº¿ç¨‹å¼€å§‹
    val image = withContext(Dispatchers.IO) {  // ğŸ‘ˆ åˆ‡æ¢åˆ° IO çº¿ç¨‹ï¼Œå¹¶åœ¨æ‰§è¡Œå®Œæˆååˆ‡å› UI çº¿ç¨‹
        getImage(imageId)                      // ğŸ‘ˆ å°†ä¼šè¿è¡Œåœ¨ IO çº¿ç¨‹
    }
    avatarIv.setImageBitmap(image)             // ğŸ‘ˆ å›åˆ° UI çº¿ç¨‹æ›´æ–° UI
} 
```

è¿™ç§å†™æ³•çœ‹ä¸Šå»å¥½åƒå’Œåˆšæ‰é‚£ç§åŒºåˆ«ä¸å¤§ï¼Œä½†å¦‚æœä½ éœ€è¦é¢‘ç¹åœ°è¿›è¡Œçº¿ç¨‹åˆ‡æ¢ï¼Œè¿™ç§å†™æ³•çš„ä¼˜åŠ¿å°±ä¼šä½“ç°å‡ºæ¥ã€‚å¯ä»¥å‚è€ƒä¸‹é¢çš„å¯¹æ¯”ï¼š

```kotlin
ğŸï¸
// ç¬¬ä¸€ç§å†™æ³•
coroutineScope.launch(Dispatchers.IO) {
    ...
    launch(Dispatchers.Main){
        ...
        launch(Dispatchers.IO) {
            ...
            launch(Dispatchers.Main) {
                ...
            }
        }
    }
}

// é€šè¿‡ç¬¬äºŒç§å†™æ³•æ¥å®ç°ç›¸åŒçš„é€»è¾‘
coroutineScope.launch(Dispatchers.Main) {
    ...
    withContext(Dispatchers.IO) {
        ...
    }
    ...
    withContext(Dispatchers.IO) {
        ...
    }
    ...
}
```

ç”±äºå¯ä»¥"è‡ªåŠ¨åˆ‡å›æ¥"ï¼Œæ¶ˆé™¤äº†å¹¶å‘ä»£ç åœ¨åä½œæ—¶çš„åµŒå¥—ã€‚ç”±äºæ¶ˆé™¤äº†åµŒå¥—å…³ç³»ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥æŠŠ `withContext` æ”¾è¿›ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°é‡Œé¢ï¼š

```kotlin
ğŸï¸
launch(Dispatchers.Main) {              // ğŸ‘ˆ åœ¨ UI çº¿ç¨‹å¼€å§‹
    val image = getImage(imageId)
    avatarIv.setImageBitmap(image)     // ğŸ‘ˆ æ‰§è¡Œç»“æŸåï¼Œè‡ªåŠ¨åˆ‡æ¢å› UI çº¿ç¨‹
}
//                               ğŸ‘‡
fun getImage(imageId: Int) = withContext(Dispatchers.IO) {
    ...
}
```

è¿™å°±æ˜¯ä¹‹å‰è¯´çš„ã€Œç”¨åŒæ­¥çš„æ–¹å¼å†™å¼‚æ­¥çš„ä»£ç ã€äº†ã€‚

ä¸è¿‡å¦‚æœåªæ˜¯è¿™æ ·å†™ï¼Œç¼–è¯‘å™¨æ˜¯ä¼šæŠ¥é”™çš„ï¼š

```kotlin
ğŸï¸
fun getImage(imageId: Int) = withContext(Dispatchers.IO) {
    // IDE æŠ¥é”™ Suspend function'withContext' should be called only from a coroutine or another suspend funcion
}
```

æ„æ€æ˜¯è¯´ï¼Œ`withContext` æ˜¯ä¸€ä¸ª `suspend` å‡½æ•°ï¼Œå®ƒéœ€è¦åœ¨åç¨‹æˆ–è€…æ˜¯å¦ä¸€ä¸ª `suspend` å‡½æ•°ä¸­è°ƒç”¨ã€‚

## suspend

`suspend` æ˜¯ Kotlin åç¨‹æœ€æ ¸å¿ƒçš„å…³é”®å­—ï¼Œå‡ ä¹æ‰€æœ‰ä»‹ç» Kotlin åç¨‹çš„æ–‡ç« å’Œæ¼”è®²éƒ½ä¼šæåˆ°å®ƒã€‚å®ƒçš„ä¸­æ–‡æ„æ€æ˜¯ã€Œæš‚åœã€æˆ–è€…ã€Œå¯æŒ‚èµ·ã€ã€‚å¦‚æœä½ å»çœ‹ä¸€äº›æŠ€æœ¯åšå®¢æˆ–å®˜æ–¹æ–‡æ¡£çš„æ—¶å€™ï¼Œå¤§æ¦‚å¯ä»¥äº†è§£åˆ°ï¼šã€Œä»£ç æ‰§è¡Œåˆ° `suspend` å‡½æ•°çš„æ—¶å€™ä¼šã€æŒ‚èµ·ã€ï¼Œå¹¶ä¸”è¿™ä¸ªã€æŒ‚èµ·ã€æ˜¯éé˜»å¡å¼çš„ï¼Œå®ƒä¸ä¼šé˜»å¡ä½ å½“å‰çš„çº¿ç¨‹ã€‚ã€

ä¸Šé¢æŠ¥é”™çš„ä»£ç ï¼Œå…¶å®åªéœ€è¦åœ¨å‰é¢åŠ ä¸€ä¸ª `suspend` å°±èƒ½å¤Ÿç¼–è¯‘é€šè¿‡ï¼š

```kotlin
ğŸï¸
//ğŸ‘‡
suspend fun getImage(imageId: Int) = withContext(Dispatchers.IO) {
    ...
}
```

æœ¬ç¯‡æ–‡ç« åˆ°æ­¤ç»“æŸï¼Œè€Œ `suspend` å…·ä½“æ˜¯ä»€ä¹ˆï¼Œã€Œéé˜»å¡å¼ã€åˆæ˜¯æ€ä¹ˆå›äº‹ï¼Œå‡½æ•°æ€ä¹ˆè¢«æŒ‚èµ·ï¼Œè¿™äº›ç–‘é—®çš„ç­”æ¡ˆï¼Œå°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« å…¨éƒ¨æ­æ™“ã€‚



## ä»€ä¹ˆæ˜¯åç¨‹

![image-20210819234404318](../img/image-20210819234404318.png)

![image-20210819234456780](../img/image-20210819234456780.png)

è¿™ç§ç»“æ„çš„ä»£ç æ— è®ºæ˜¯é˜…è¯»èµ·æ¥è¿˜æ˜¯ç»´æŠ¤èµ·æ¥éƒ½æ˜¯æå…¶ç³Ÿç³•çš„ã€‚*å¯¹å¤šä¸ªå›è°ƒç»„æˆçš„åµŒå¥—è€¦åˆï¼Œæˆ‘äº²åˆ‡çš„ç§°ä¸ºå›è°ƒåœ°ç‹±*

![image-20210819234701883](../img/image-20210819234701883.png)

![image-20210819234753552](../img/image-20210819234753552.png)

![image-20210819234815429](../img/image-20210819234815429.png)

![image-20210819234836774](../img/image-20210819234836774.png)

![image-20210819234853360](../img/image-20210819234853360.png)

## åç¨‹çš„ç”¨æ³•

![image-20210819234923411](../img/image-20210819234923411.png)

![image-20210819235026711](../img/image-20210819235026711.png)

![image-20210819235044123](../img/image-20210819235044123.png)

![image-20210819235150692](../img/image-20210819235150692.png)

![image-20210819235226082](../img/image-20210819235226082.png)

![image-20210819235408852](../img/image-20210819235408852.png)

![image-20210819235427192](../img/image-20210819235427192.png)

## åç¨‹æŒ‚èµ·ã€æ¢å¤åŸç†é€†å‘å‰–æ

![image-20210819235635157](../img/image-20210819235635157.png)

![image-20210819235714296](../img/image-20210819235714296.png)

![image-20210819235740596](../img/image-20210819235740596.png)

![image-20210819235831141](../img/image-20210819235831141.png)

## åç¨‹å›é¡¾

![image-20210819235947086](../img/image-20210819235947086.png)

![image-20210820000012910](../img/image-20210820000012910.png)

## åç¨‹çš„åº”ç”¨

### éœ€æ±‚åˆ†æ

![image-20210820000129607](../img/image-20210820000129607.png)

![image-20210820000203896](../img/image-20210820000203896.png)

![image-20210820000240124](../img/image-20210820000240124.png)

![image-20210820000349276](../img/image-20210820000349276.png)

![image-20210826225305910](../img/image-20210826225305910.png)



## å‚è€ƒ

1. [Android ä¸Šçš„ Kotlin åç¨‹](https://developer.android.google.cn/kotlin/coroutines)
2. [åˆ©ç”¨ Kotlin åç¨‹æå‡åº”ç”¨æ€§èƒ½](https://developer.android.google.cn/kotlin/coroutines/coroutines-adv)
3.  https://github.com/android/architecture-components-samples.git



